{"version":3,"file":"55bbc67b.js","sources":["../../../node_modules/kolorist/dist/module/index.js","../../../node_modules/@shopify/hydrogen/dist/esnext/utilities/log/log.js","../../../node_modules/@shopify/hydrogen/dist/esnext/foundation/ServerRequestProvider/ServerRequestProvider.js","../../../node_modules/@shopify/hydrogen/dist/esnext/foundation/Analytics/const.js","../../../node_modules/@shopify/hydrogen/dist/esnext/foundation/Analytics/utils.js"],"sourcesContent":["var enabled = true;\n// Support both browser and node environments\nvar globalVar = typeof self !== 'undefined'\n    ? self\n    : typeof window !== 'undefined'\n        ? window\n        : typeof global !== 'undefined'\n            ? global\n            : {};\n/**\n * Detect how much colors the current terminal supports\n */\nvar supportLevel = 0 /* none */;\nif (globalVar.process && globalVar.process.env && globalVar.process.stdout) {\n    var _a = globalVar.process.env, FORCE_COLOR = _a.FORCE_COLOR, NODE_DISABLE_COLORS = _a.NODE_DISABLE_COLORS, TERM = _a.TERM;\n    if (NODE_DISABLE_COLORS || FORCE_COLOR === '0') {\n        enabled = false;\n    }\n    else if (FORCE_COLOR === '1') {\n        enabled = true;\n    }\n    else if (TERM === 'dumb') {\n        enabled = false;\n    }\n    else if ('CI' in globalVar.process.env &&\n        [\n            'TRAVIS',\n            'CIRCLECI',\n            'APPVEYOR',\n            'GITLAB_CI',\n            'GITHUB_ACTIONS',\n            'BUILDKITE',\n            'DRONE',\n        ].some(function (vendor) { return vendor in globalVar.process.env; })) {\n        enabled = true;\n    }\n    else {\n        enabled = process.stdout.isTTY;\n    }\n    if (enabled) {\n        supportLevel =\n            TERM && TERM.endsWith('-256color')\n                ? 2 /* ansi256 */\n                : 1 /* ansi */;\n    }\n}\nexport var options = {\n    enabled: enabled,\n    supportLevel: supportLevel,\n};\nfunction kolorist(start, end, level) {\n    if (level === void 0) { level = 1 /* ansi */; }\n    var open = \"\\u001B[\" + start + \"m\";\n    var close = \"\\u001B[\" + end + \"m\";\n    var regex = new RegExp(\"\\\\x1b\\\\[\" + end + \"m\", 'g');\n    return function (str) {\n        return options.enabled && options.supportLevel >= level\n            ? open + ('' + str).replace(regex, open) + close\n            : '' + str;\n    };\n}\nexport function stripColors(str) {\n    return ('' + str)\n        .replace(/\\x1b\\[[0-9;]+m/g, '')\n        .replace(/\\x1b\\]8;;.*?\\x07(.*?)\\x1b\\]8;;\\x07/g, function (_, group) { return group; });\n}\n// modifiers\nexport var reset = kolorist(0, 0);\nexport var bold = kolorist(1, 22);\nexport var dim = kolorist(2, 22);\nexport var italic = kolorist(3, 23);\nexport var underline = kolorist(4, 24);\nexport var inverse = kolorist(7, 27);\nexport var hidden = kolorist(8, 28);\nexport var strikethrough = kolorist(9, 29);\n// colors\nexport var black = kolorist(30, 39);\nexport var red = kolorist(31, 39);\nexport var green = kolorist(32, 39);\nexport var yellow = kolorist(33, 39);\nexport var blue = kolorist(34, 39);\nexport var magenta = kolorist(35, 39);\nexport var cyan = kolorist(36, 39);\nexport var white = kolorist(97, 39);\nexport var gray = kolorist(90, 39);\nexport var lightGray = kolorist(37, 39);\nexport var lightRed = kolorist(91, 39);\nexport var lightGreen = kolorist(92, 39);\nexport var lightYellow = kolorist(93, 39);\nexport var lightBlue = kolorist(94, 39);\nexport var lightMagenta = kolorist(95, 39);\nexport var lightCyan = kolorist(96, 39);\n// background colors\nexport var bgBlack = kolorist(40, 49);\nexport var bgRed = kolorist(41, 49);\nexport var bgGreen = kolorist(42, 49);\nexport var bgYellow = kolorist(43, 49);\nexport var bgBlue = kolorist(44, 49);\nexport var bgMagenta = kolorist(45, 49);\nexport var bgCyan = kolorist(46, 49);\nexport var bgWhite = kolorist(107, 49);\nexport var bgGray = kolorist(100, 49);\nexport var bgLightRed = kolorist(101, 49);\nexport var bgLightGreen = kolorist(102, 49);\nexport var bgLightYellow = kolorist(103, 49);\nexport var bgLightBlue = kolorist(104, 49);\nexport var bgLightMagenta = kolorist(105, 49);\nexport var bgLightCyan = kolorist(106, 49);\nexport var bgLightGray = kolorist(47, 49);\n// 256 support\nexport var ansi256 = function (n) {\n    return kolorist('38;5;' + n, 0, 2 /* ansi256 */);\n};\nexport var ansi256Bg = function (n) {\n    return kolorist('48;5;' + n, 0, 2 /* ansi256 */);\n};\n// Links\nvar OSC = '\\u001B]';\nvar BEL = '\\u0007';\nvar SEP = ';';\nexport function link(text, url) {\n    return options.enabled\n        ? OSC + '8' + SEP + SEP + url + BEL + text + OSC + '8' + SEP + SEP + BEL\n        : text + \" (\\u200B\" + url + \"\\u200B)\";\n}\n//# sourceMappingURL=index.js.map","import { yellow, red, green, italic, lightBlue } from 'kolorist';\nimport { getTime } from '../timing';\nimport { parseUrl } from './utils';\nconst defaultLogger = {\n    trace(context, ...args) {\n        // Re-enable following line to show trace debugging information\n        // console.log(context.id, ...args);\n    },\n    debug(context, ...args) {\n        console.log(...args);\n    },\n    warn(context, ...args) {\n        console.warn(yellow('WARN: '), ...args);\n    },\n    error(context, ...args) {\n        console.error(red('ERROR: '), ...args);\n    },\n    fatal(context, ...args) {\n        console.error(red('FATAL: '), ...args);\n    },\n    options: () => ({}),\n};\nglobalThis.__logger = defaultLogger;\nfunction buildLogger() {\n    return {\n        trace: (...args) => globalThis.__logger.trace(this, ...args),\n        debug: (...args) => globalThis.__logger.debug(this, ...args),\n        warn: (...args) => globalThis.__logger.warn(this, ...args),\n        error: (...args) => globalThis.__logger.error(this, ...args),\n        fatal: (...args) => globalThis.__logger.fatal(this, ...args),\n        options: () => globalThis.__logger.options(),\n    };\n}\nexport const log = buildLogger.call({});\nexport function getLoggerWithContext(context = {}) {\n    return buildLogger.call(context);\n}\nexport function setLogger(newLogger) {\n    globalThis.__logger = newLogger;\n}\nexport function setLoggerOptions(options) {\n    globalThis.__logger.options = () => options;\n}\nexport function resetLogger() {\n    globalThis.__logger = defaultLogger;\n}\nconst SERVER_RESPONSE_MAP = {\n    str: 'streaming SSR',\n    rsc: 'Server Components',\n    ssr: 'buffered SSR',\n};\nexport function logServerResponse(type, request, responseStatus) {\n    const log = getLoggerWithContext(request);\n    const coloredResponseStatus = responseStatus >= 500\n        ? red(responseStatus)\n        : responseStatus >= 400\n            ? yellow(responseStatus)\n            : responseStatus >= 300\n                ? lightBlue(responseStatus)\n                : green(responseStatus);\n    const fullType = SERVER_RESPONSE_MAP[type] || type;\n    const styledType = italic(fullType.padEnd(17));\n    const paddedTiming = ((getTime() - request.time).toFixed(2) + ' ms').padEnd(10);\n    const url = parseUrl(type, request.url);\n    log.debug(`${request.method} ${styledType} ${coloredResponseStatus} ${paddedTiming} ${url}`);\n}\n","import React, { createContext, useContext } from 'react';\nimport { getTime } from '../../utilities/timing';\nimport { hashKey } from '../../utilities/hash';\nimport { collectQueryTimings } from '../../utilities/log';\n// Context to inject current request in SSR\nconst RequestContextSSR = createContext(null);\n// Cache to inject current request in RSC\nfunction requestCacheRSC() {\n    return new Map();\n}\nrequestCacheRSC.key = Symbol.for('HYDROGEN_REQUEST');\nexport function ServerRequestProvider({ isRSC, request, children, }) {\n    if (isRSC) {\n        // Save the request object in a React cache that is\n        // scoped to this current rendering.\n        // @ts-ignore\n        const requestCache = React.unstable_getCacheForType(requestCacheRSC);\n        requestCache.set(requestCacheRSC.key, request);\n        return children;\n    }\n    // Use a normal provider in SSR to make the request object\n    // available in the current rendering.\n    return (React.createElement(RequestContextSSR.Provider, { value: request }, children));\n}\nexport function useServerRequest() {\n    let request;\n    try {\n        // This cache only works during RSC rendering:\n        // @ts-ignore\n        const cache = React.unstable_getCacheForType(requestCacheRSC);\n        request = cache ? cache.get(requestCacheRSC.key) : null;\n    }\n    catch (_a) {\n        // If RSC cache failed it means this is not an RSC request.\n        // Try getting SSR context instead:\n        request = useContext(RequestContextSSR); // eslint-disable-line react-hooks/rules-of-hooks\n    }\n    if (!request) {\n        // @ts-ignore\n        if (__DEV__ && typeof jest !== 'undefined') {\n            // Unit tests are not wrapped in ServerRequestProvider.\n            // This mocks it, instead of providing it in every test.\n            return { ctx: {} };\n        }\n        throw new Error('No ServerRequest Context found');\n    }\n    return request;\n}\n/**\n * Returns data stored in the request cache.\n * It will throw the promise if data is not ready.\n */\nexport function useRequestCacheData(key, fetcher) {\n    const request = useServerRequest();\n    const cache = request.ctx.cache;\n    const cacheKey = hashKey(key);\n    if (!cache.has(cacheKey)) {\n        let result;\n        let promise;\n        cache.set(cacheKey, () => {\n            if (result !== undefined) {\n                collectQueryTimings(request, key, 'rendered');\n                return result;\n            }\n            if (!promise) {\n                const startApiTime = getTime();\n                const maybePromise = fetcher();\n                if (!(maybePromise instanceof Promise)) {\n                    result = { data: maybePromise };\n                    return result;\n                }\n                promise = maybePromise.then((data) => {\n                    result = { data };\n                    collectQueryTimings(request, key, 'resolved', getTime() - startApiTime);\n                }, (error) => (result = { error }));\n            }\n            throw promise;\n        });\n    }\n    // Making sure the promise has returned data because it can be initated by a preload request,\n    // otherwise, we throw the promise\n    const result = cache.get(cacheKey).call();\n    if (result instanceof Promise)\n        throw result;\n    return result;\n}\nexport function preloadRequestCacheData(request, preloadQueries) {\n    const cache = request.ctx.cache;\n    preloadQueries === null || preloadQueries === void 0 ? void 0 : preloadQueries.forEach((preloadQuery, cacheKey) => {\n        collectQueryTimings(request, preloadQuery.key, 'preload');\n        if (!cache.has(cacheKey)) {\n            let result;\n            let promise;\n            cache.set(cacheKey, () => {\n                if (result !== undefined) {\n                    collectQueryTimings(request, preloadQuery.key, 'rendered');\n                    return result;\n                }\n                if (!promise) {\n                    const startApiTime = getTime();\n                    promise = preloadQuery.fetcher().then((data) => {\n                        result = { data };\n                        collectQueryTimings(request, preloadQuery.key, 'resolved', getTime() - startApiTime);\n                    }, (error) => {\n                        result = { error };\n                    });\n                }\n                return promise;\n            });\n        }\n        cache.get(cacheKey).call();\n    });\n}\n","export const eventNames = {\n    PAGE_VIEW: 'page-view',\n    VIEWED_PRODUCT: 'viewed-product',\n    ADD_TO_CART: 'add-to-cart',\n    REMOVE_FROM_CART: 'remove-from-cart',\n    UPDATE_CART: 'update-cart',\n    DISCOUNT_CODE_UPDATED: 'discount-code-updated',\n    PERFORMANCE: 'performance',\n};\n","import { eventNames } from './const';\nconst RESERVED_EVENT_NAMES = Object.values(eventNames);\nexport function getNamedspacedEventname(eventname) {\n    // Any event name that is not in the reserved space will be prefix with `c-`\n    return RESERVED_EVENT_NAMES.indexOf(eventname) === -1\n        ? `c-${eventname}`\n        : eventname;\n}\n"],"names":["createContext"],"mappings":"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"}